(()=>{"use strict";var t,e={315:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerStates=void 0;var s,a=n(375);!function(t){t[t.DEAD=0]="DEAD",t[t.HURT=1]="HURT",t[t.IDLE=2]="IDLE",t[t.SHOT1=3]="SHOT1",t[t.SHOT2=4]="SHOT2"}(s=e.PlayerStates||(e.PlayerStates={}));var i=function(t){function e(n,r,o,i){var c=t.call(this,n,r,o,i)||this;return c.createAnimations(),c.scene.add.existing(c),c.hp=new a.default(n,r,o-32,e.MAX_HP),c.resetCharacter(),c.on(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+"".concat(c.texture.key,"-shot1"),(function(){c.setState(s.IDLE)})),c.on(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+"".concat(c.texture.key,"-shot2"),(function(){c.setState(s.IDLE)})),c.on(Phaser.Animations.Events.ANIMATION_COMPLETE_KEY+"".concat(c.texture.key,"-hurt"),(function(){c.setState(s.IDLE)})),c}return o(e,t),e.prototype.setState=function(e){switch(e){case s.DEAD:this.play("".concat(this.texture.key,"-dead")).playAudio(Math.random()<.5?"death1":"death2");break;case s.HURT:this.hp.decrease(Math.random()<.5?100:200)?this.setState(s.DEAD):this.play("".concat(this.texture.key,"-hurt"));break;case s.IDLE:this.play("".concat(this.texture.key,"-idle"));break;case s.SHOT1:this.rescheduleShot(),this.scene.events.emit("enemy-shot",this.texture.key),this.play("".concat(this.texture.key,"-shot1")).playAudio(Math.random()<.5?"shot1":"shot2");break;case s.SHOT2:this.rescheduleShot(),this.scene.events.emit("enemy-shot",this.texture.key),this.play("".concat(this.texture.key,"-shot2")).playAudio(Math.random()<.5?"shot1":"shot2")}return t.prototype.setState.call(this,e)},e.prototype.preUpdate=function(e,n){t.prototype.preUpdate.call(this,e,n)},e.prototype.rescheduleShot=function(){var t=this;this.scene.time.addEvent({delay:2e3+3e3*Math.random(),callback:function(){t.setState(Math.random()<.5?s.SHOT1:s.SHOT2)},callbackScope:this})},e.prototype.setSize=function(e){return t.prototype.setSize.call(this,16,e),this},e.prototype.playAudio=function(t){return this.scene.sound.play(t,{volume:.5}),this},e.prototype.resetCharacter=function(){this.setState(s.IDLE),this.hp.value=e.MAX_HP,this.hp.draw(),this.rescheduleShot()},e.MAX_HP=1500,e}(Phaser.Physics.Arcade.Sprite);e.default=i},992:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n,r){return t.call(this,e,n,r,"soldier1")||this}return o(e,t),e.prototype.createAnimations=function(){var t=this;[{key:"".concat(this.texture.key,"-dead"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[0,1,2,3]})},{key:"".concat(this.texture.key,"-hurt"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[4,5,6]})},{key:"".concat(this.texture.key,"-idle"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[7,8,9,10,11,12,13]}),repeat:-1},{key:"".concat(this.texture.key,"-shot1"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[14,15,16,17]})},{key:"".concat(this.texture.key,"-shot2"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[18,19,20,21]})}].forEach((function(e){return t.scene.anims.create(e)}))},e}(n(315).default);e.default=s},665:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n,r){var o=t.call(this,e,n,r,"soldier2")||this;return o.flipX=!o.flipX,o}return o(e,t),e.prototype.createAnimations=function(){var t=this;[{key:"".concat(this.texture.key,"-dead"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[0,1,2,3]})},{key:"".concat(this.texture.key,"-hurt"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[4,5,6]})},{key:"".concat(this.texture.key,"-idle"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[7,8,9,10,11,12,13,14,15]}),repeat:-1},{key:"".concat(this.texture.key,"-shot1"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[16,17,18,19]})},{key:"".concat(this.texture.key,"-shot2"),frameRate:12,frames:this.scene.anims.generateFrameNumbers(this.texture.key,{frames:[20,21,22,23]})}].forEach((function(e){return t.scene.anims.create(e)}))},e}(n(315).default);e.default=s},206:(t,e,n)=>{n(260);var r=n(859),o=n(755),s=n(713),a={type:Phaser.AUTO,width:320,height:192,zoom:2,backgroundColor:"#fdfdfd",render:{pixelArt:!0,antialias:!1,antialiasGL:!1},scene:[r.default,o.default]};window.addEventListener("load",(function(){new Phaser.Game(a),(0,s.createChatDomElements)()}))},859:function(t,e){var n,r=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.preload=function(){this.load.audio("death1","./assets/audio/death1.mp3"),this.load.audio("death2","./assets/audio/death2.mp3"),this.load.audio("shot1","./assets/audio/shot1.mp3"),this.load.audio("shot2","./assets/audio/shot2.mp3"),this.load.spritesheet("soldier1","./assets/images/soldier1.png",{frameWidth:128,frameHeight:128}),this.load.spritesheet("soldier2","./assets/images/soldier2.png",{frameWidth:128,frameHeight:128}),this.load.spritesheet("soldier3","./assets/images/soldier3.png",{frameWidth:128,frameHeight:128}),this.load.image("grey-button-03","./assets/images/uipack_fixed/PNG/grey_button03.png"),this.load.image("grey-button-04","./assets/images/uipack_fixed/PNG/grey_button04.png")},e.prototype.create=function(){this.scene.start("shooter")},e}(Phaser.Scene);e.default=o},755:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(315),a=n(992),i=n(665),c=function(t){function e(){return t.call(this,{key:"shooter",active:!1,visible:!1})||this}return o(e,t),e.prototype.preload=function(){},e.prototype.create=function(){var t=this;this._npc1=new a.default(this,64,128),this._npc2=new i.default(this,256,128),this.cameras.main.setBounds(0,0,320,192),this.events.on("enemy-shot",(function(e){e===t._npc1.texture.key?t._npc2.setState(s.PlayerStates.HURT):e===t._npc2.texture.key&&t._npc1.setState(s.PlayerStates.HURT);var n=!t._npc2.hp.value,r=!t._npc1.hp.value;(n||r)&&(t.time.clearPendingEvents(),t.time.removeAllEvents(),t.showInfoAndMenu(n?1:2))}))},e.prototype.showInfoAndMenu=function(t){var e,n,r,o=this;null===(e=this.textWinner)||void 0===e||e.destroy(),this.textWinner=this.add.text(70,15,"Победил персонаж ".concat(t),{fontFamily:"Arial",fontSize:18,color:"#000000"}),null===(n=this.textButton)||void 0===n||n.destroy(),this.textButton=this.add.text(132,52,"Новый бой",{fontFamily:"Arial",fontSize:11,color:"#000000"}),this.textButton.setDepth(1),null===(r=this.button)||void 0===r||r.destroy(),this.button=this.add.nineslice(160,60,"grey-button-03",0,80,30,2,2,2,2),this.button.setInteractive(),this.button.on("pointerdown",(function(){var t;null===(t=o.button)||void 0===t||t.destroy(),o.button=o.add.nineslice(160,60,"grey-button-04",0,80,30,2,2,2,2),o.button.setInteractive(),o.textButton.y+=1,o.button.on("pointerup",(function(){var t,e,n;null===(t=o.textWinner)||void 0===t||t.destroy(),null===(e=o.button)||void 0===e||e.destroy(),null===(n=o.textButton)||void 0===n||n.destroy(),o._npc1.resetCharacter(),o._npc2.resetCharacter()}))}))},e}(Phaser.Scene);e.default=c},154:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.makeRequest=e.httpRequest=void 0,e.makeRequest=function(t,n,r,o){return e.httpRequest=new XMLHttpRequest,e.httpRequest?(e.httpRequest.onreadystatechange=o,e.httpRequest.open(t,n),e.httpRequest.send(r),!0):(alert("Giving up :( Cannot create an XMLHTTP instance"),!1)}},713:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createChatDomElements=void 0;var r,o=n(154);function s(t){var e=document.createElement("div");return e.textContent=t,r.appendChild(e),e}function a(){(0,o.makeRequest)("GET","http://127.0.0.1:3000",void 0,(function(){o.httpRequest.readyState===XMLHttpRequest.DONE&&(200===o.httpRequest.status?function(){try{var t=JSON.parse(o.httpRequest.responseText);r.replaceChildren();for(var e=0,n=t.items;e<n.length;e++){var a=n[e],i=a.millis,c=a.message,u=new Date(0);u.setUTCMilliseconds(i),s("[".concat(u.toLocaleString(),"] ").concat(c))}}catch(t){console.log("Ошибка при парсинге: ",t)}}():s("[".concat((new Date).toLocaleString(),"] Проблема с GET запросом к http://127.0.0.1:3000")).style.color="#FF0000")}))}e.createChatDomElements=function(){var t,e;(r=document.createElement("div")).style.background="#FAFAFA",r.style.width="640px",r.style.maxWidth="640px",r.style.height="120px",r.style.maxHeight="120px",r.style.padding="0",r.style.margin="0",r.style.overflow="auto",a();var n=document.createElement("input");n.style.width="640px",n.style.maxWidth="640px",n.style.padding="0",n.style.margin="0",n.addEventListener("keypress",(function(t){var e;"Enter"===t.key&&t.target instanceof HTMLInputElement&&(e=n.value,(0,o.makeRequest)("POST","http://127.0.0.1:3000",e,(function(){o.httpRequest.readyState===XMLHttpRequest.DONE&&(200===o.httpRequest.status?a():s("[".concat((new Date).toLocaleString(),"] Проблема с POST запросом к http://127.0.0.1:3000")).style.color="#FF0000")})),n.value="")})),setInterval(a,5e3),null===(t=document.body)||void 0===t||t.appendChild(r),null===(e=document.body)||void 0===e||e.appendChild(n)}},375:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(e,n,r,o){this.bar=new Phaser.GameObjects.Graphics(e),this.scene=e,this.x=n-t.WIDTH/2,this.y=r-t.HEIGHT/2,this.max=o,this.value=o,this.p=(t.WIDTH-2*t.EDGE)/o,this.draw(),e.add.existing(this.bar)}return t.prototype.damageText=function(e){var n,r,o=this;null===(n=this.text)||void 0===n||n.destroy(),this.text=this.scene.add.text(this.x+t.WIDTH/2,this.y,"-".concat(e),{fontFamily:"Arial",fontSize:t.TEXT_SIZE,color:"#00FF00"}).setOrigin(.5,.5),null===(r=this.tween)||void 0===r||r.destroy(),this.tween=this.scene.tweens.addCounter({from:0,to:1,duration:1e3,yoyo:!1,onUpdate:function(e){var n=e.getValue(),r=255*n;o.text.y-=n,o.text.setFontSize(t.TEXT_SIZE-n*t.TEXT_SIZE),o.text.setColor("rgb(".concat(r,", ").concat(r,", ").concat(r,")"))}})},t.prototype.decrease=function(t){return this.damageText(t),this.value-=t,this.value<0&&(this.value=0),this.draw(),0===this.value},t.prototype.draw=function(){this.bar.clear(),this.bar.fillStyle(0),this.bar.fillRect(this.x,this.y,t.WIDTH,t.HEIGHT),this.bar.fillStyle(16777215),this.bar.fillRect(this.x+t.EDGE,this.y+t.EDGE,t.WIDTH-2*t.EDGE,t.HEIGHT-2*t.EDGE),100*this.value/this.max<30?this.bar.fillStyle(16711680):this.bar.fillStyle(65280);var e=Math.floor(this.p*this.value);this.bar.fillRect(this.x+t.EDGE,this.y+t.EDGE,e,t.HEIGHT-2*t.EDGE)},t.EDGE=2,t.WIDTH=64,t.HEIGHT=8,t.TEXT_SIZE=30,t}();e.default=n}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var s=n[t]={exports:{}};return e[t].call(s.exports,s,s.exports,r),s.exports}r.m=e,t=[],r.O=(e,n,o,s)=>{if(!n){var a=1/0;for(h=0;h<t.length;h++){for(var[n,o,s]=t[h],i=!0,c=0;c<n.length;c++)(!1&s||a>=s)&&Object.keys(r.O).every((t=>r.O[t](n[c])))?n.splice(c--,1):(i=!1,s<a&&(a=s));if(i){t.splice(h--,1);var u=o();void 0!==u&&(e=u)}}return e}s=s||0;for(var h=t.length;h>0&&t[h-1][2]>s;h--)t[h]=t[h-1];t[h]=[n,o,s]},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};r.O.j=e=>0===t[e];var e=(e,n)=>{var o,s,[a,i,c]=n,u=0;if(a.some((e=>0!==t[e]))){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(c)var h=c(r)}for(e&&e(n);u<a.length;u++)s=a[u],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return r.O(h)},n=self.webpackChunkphaser_webpack=self.webpackChunkphaser_webpack||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var o=r.O(void 0,[426],(()=>r(206)));o=r.O(o)})();